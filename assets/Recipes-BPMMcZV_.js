import{r as v,T as J,O as Q,d as $,m as D,u as S,c as b,o as g,a as t,b as e,e as i,V as w,f as z,y as U,t as C,h as x,F as T,j as R,g as G,i as L,L as Z,U as E,W as X,R as c}from"./index-C8Ptw20l.js";import{p as Y,V as M,q as ee,r as te,s as le,t as ae,b as h,e as oe,a as se,n as ne,o as re}from"./VSheet-DbGd0L3R.js";import{V as I,a as A,g as ie,b as K,c as j,f as _,d as q,e as B,h as de}from"./VRow-DnGqdudk.js";function ue(){const m=v(null);async function o(u){try{const d=`https://corsproxy.io/?url=${encodeURIComponent("https://ftapi.pythonanywhere.com/translate?sl=pl&dl=en&text="+u.join(","))}`,l=await fetch(d,{method:"GET",headers:{"Content-Type":"application/json"}});if(!l.ok)throw new Error("Błąd tłumaczenia nazw produktów");return(await l.json())["destination-text"].split(",")}catch(d){return m.value=d.message||"Błąd tłumaczenia",u}}return{translate:o,translateError:m}}const pe=J("Recipes",()=>{const m=Q(),o=Y("recipes",[]),u=v(!1),d=v([]),l=v(!1),n=v(null),s=v([]),f=v(null),r=ue();function a(){d.value=[],s.value=[],n.value=null,u.value=!0}function p(){u.value=!1,l.value=!1,s.value=[],n.value=null,d.value=[]}async function P(V){l.value=!0,n.value=null,s.value=[];try{const y=d.value.map(H=>H.name),k=await r.translate(y);if(r.translateError.value){n.value=r.translateError.value;return}const N=await fetch(`https://api.spoonacular.com/recipes/findByIngredients?ingredients=${k.join(",")}&apiKey=${V}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!N.ok)throw new Error("Błąd pobierania przepisów");s.value=await N.json()}catch(y){n.value=y.message||"Nieznany błąd"}finally{l.value=!1}}async function F(V){var y;try{const k=await fetch(`https://api.spoonacular.com/recipes/${(y=f.value)==null?void 0:y.id}/information?apiKey=${V}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!k.ok)throw new Error("Błąd pobierania przepisów");f.value=await k.json()}catch(k){m.addMessage(k.message||"Nieznany błąd","NOK")}}function O(V){o.value.some(y=>y.id===V.id)||(o.value.push({...V}),m.addMessage("Dodano przepis","OK"))}function W(V){const y=o.value.findIndex(k=>k.id===V.id);y!==-1&&o.value.splice(y,1)}return{recipes:o,recipeDialog:u,selectedRecipe:f,selectedProducts:d,loading:l,error:n,fetchedRecipes:s,openRecipeDialog:a,closeRecipeDialog:p,fetchRecipes:P,addRecipe:O,removeRecipe:W,getRecipeDetails:F}}),ce={class:"font-weight-bold"},me={class:"ml-1"},fe=$({__name:"RecipeIngredientsDialog",props:D({ingredients:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(m){const o=S(m,"modelValue"),u=m;return(d,l)=>(g(),b(M,{modelValue:o.value,"onUpdate:modelValue":l[1]||(l[1]=n=>o.value=n),"max-width":"500"},{default:t(()=>[e(j,null,{default:t(()=>[e(I,{class:"text-h6"},{default:t(()=>[e(w,{color:"primary",class:"mr-2"},{default:t(()=>l[2]||(l[2]=[i("mdi-food-apple")])),_:1}),l[3]||(l[3]=i(" Składniki "))]),_:1}),e(A,{class:"pa-2"},{default:t(()=>[e(ee,{density:"compact"},{default:t(()=>[(g(!0),z(T,null,U(u.ingredients,n=>(g(),b(te,{key:n.id,class:"py-2",density:"compact"},{prepend:t(()=>[e(ie,{size:"28",color:"green-lighten-4",image:n.image},null,8,["image"])]),default:t(()=>[e(le,{class:"font-weight-medium"},{default:t(()=>[i(C(n.name.charAt(0).toUpperCase()+n.name.slice(1)),1)]),_:2},1024),e(ae,null,{default:t(()=>[l[4]||(l[4]=i(" Ilość: ")),x("span",ce,C(n.amount),1),x("span",me,C(n.unit),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),e(K,null,{default:t(()=>[e(h),e(R,{color:"primary",variant:"tonal",onClick:l[0]||(l[0]=n=>o.value=!1)},{default:t(()=>l[5]||(l[5]=[i(" Zamknij ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),ve={key:1,class:"mt-4"},ge=$({__name:"RecipeDialog",props:D({allProducts:{},loading:{type:Boolean},recipes:{},error:{}},{open:{type:Boolean,required:!0},openModifiers:{},"selected-products":{required:!0},"selected-productsModifiers":{}}),emits:D(["fetchRecipes","addRecipe","close"],["update:open","update:selected-products"]),setup(m,{emit:o}){const u=S(m,"open"),d=S(m,"selected-products"),l=m,n=o,s=v("");return(f,r)=>(g(),b(M,{modelValue:u.value,"onUpdate:modelValue":r[3]||(r[3]=a=>u.value=a),"max-width":"600"},{default:t(()=>[e(j,null,{default:t(()=>[e(I,null,{default:t(()=>r[4]||(r[4]=[i("Wybierz produkty")])),_:1}),e(A,null,{default:t(()=>[G(x("input",{class:"w-100 border border-sm mb-2","onUpdate:modelValue":r[0]||(r[0]=a=>s.value=a),placeholder:"API key do spoonacular.com"},null,512),[[Z,s.value]]),e(oe,{modelValue:d.value,"onUpdate:modelValue":r[1]||(r[1]=a=>d.value=a),items:l.allProducts,"item-title":"name","return-object":"",multiple:"",chips:"",density:"compact","item-value":"id","list-props":{density:"compact",class:"text-caption py-0"},label:"Produkty"},null,8,["modelValue","items"]),e(R,{loading:l.loading,onClick:r[2]||(r[2]=a=>n("fetchRecipes",s.value)),color:"primary",class:"mt-4",size:"small",variant:"tonal"},{default:t(()=>[e(w,{left:"",icon:"mdi-silverware-spoon"}),r[5]||(r[5]=i(" Znajdź przepisy "))]),_:1},8,["loading"]),l.error?(g(),b(se,{key:0,type:"error",class:"mt-2"},{default:t(()=>[i(C(l.error),1)]),_:1})):L("",!0),l.recipes.length?(g(),z("div",ve,[(g(!0),z(T,null,U(l.recipes,a=>(g(),z("div",{key:a.id,class:"mb-2 text-center"},[x("strong",null,C(a.title),1),e(E,{height:"100",src:a.image,cover:""},null,8,["src"]),e(R,{color:"primary",class:"mt-1",variant:"tonal",size:"small","prepend-icon":"mdi-hexagram",onClick:p=>n("addRecipe",a)},{default:t(()=>r[6]||(r[6]=[i(" Zapisz ")])),_:2},1032,["onClick"])]))),128))])):L("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),ye=$({__name:"RecipeDetailsDialog",props:D({details:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:D(["get-details"],["update:modelValue"]),setup(m,{emit:o}){const u=S(m,"modelValue"),d=o,l=v("");return(n,s)=>(g(),b(M,{modelValue:u.value,"onUpdate:modelValue":s[3]||(s[3]=f=>u.value=f),"max-width":"500"},{default:t(()=>[e(j,null,{default:t(()=>[e(I,{class:"text-h6"},{default:t(()=>[e(w,{color:"primary",class:"mr-2"},{default:t(()=>s[4]||(s[4]=[i("mdi-food")])),_:1}),s[5]||(s[5]=i(" Szczegoły Przepisu "))]),_:1}),e(A,{class:"pa-2"},{default:t(()=>[G(x("input",{class:"w-100 border border-sm mb-2","onUpdate:modelValue":s[0]||(s[0]=f=>l.value=f),placeholder:"API key do spoonacular.com",onKeyup:s[1]||(s[1]=X(f=>d("get-details",l.value),["enter"]))},null,544),[[Z,l.value]]),x("h3",null,C(n.details.title),1),e(E,{height:"150",src:n.details.image,cover:""},null,8,["src"]),e(R,{href:n.details.sourceUrl,target:"_blank",class:"text-primary text-center mt-5",block:"",variant:"tonal"},{default:t(()=>s[6]||(s[6]=[i(" Przejdź do przepisu ")])),_:1},8,["href"])]),_:1}),e(K,null,{default:t(()=>[e(h),e(R,{color:"primary",variant:"tonal",onClick:s[2]||(s[2]=f=>u.value=!1)},{default:t(()=>s[7]||(s[7]=[i(" Zamknij ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),we=$({__name:"Recipes",setup(m){const o=pe(),u=ne(),d=v(!1),l=v(!1),n=v([]);function s(r){n.value=r.usedIngredients,d.value=!0}function f(r){o.selectedRecipe=r,l.value=!0}return(r,a)=>(g(),b(_,{fluid:""},{default:t(()=>[e(q,{dense:""},{default:t(()=>[e(B,{cols:"12"},{default:t(()=>[e(re,{elevation:"5"},{default:t(()=>[e(_,null,{default:t(()=>[e(q,null,{default:t(()=>[e(B,{cols:"12"},{default:t(()=>[e(R,{block:"",variant:"outlined",color:"primary",class:"opacity-70",onClick:c(o).openRecipeDialog},{default:t(()=>[e(w,{icon:"mdi-plus"}),a[4]||(a[4]=i(" Znajdź przepisy "))]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(B,{cols:"12"},{default:t(()=>[(g(!0),z(T,null,U(c(o).recipes,p=>(g(),b(j,{key:p.id,class:"mb-2"},{default:t(()=>[e(E,{height:"150",src:p.image,cover:""},null,8,["src"]),e(de,{class:"position-relative"},{default:t(()=>[e(w,{class:"position-absolute",style:{top:"10px",right:"5px","z-index":"2"},color:"red",onClick:P=>c(o).removeRecipe(p)},{default:t(()=>a[5]||(a[5]=[i("mdi-minus-thick ")])),_:2},1032,["onClick"]),e(I,null,{default:t(()=>[i(C(p.title),1)]),_:2},1024)]),_:2},1024),e(K,null,{default:t(()=>[e(R,{color:"primary",class:"border opacity-70",onClick:P=>s(p)},{default:t(()=>[e(w,{left:"",class:"mr-1"},{default:t(()=>a[6]||(a[6]=[i("mdi-silverware-fork-knife")])),_:1}),a[7]||(a[7]=i(" Składniki "))]),_:2},1032,["onClick"]),e(h),e(R,{color:"primary",class:"border opacity-70",onClick:P=>f(p)},{default:t(()=>[e(w,{left:"",class:"mr-1"},{default:t(()=>a[8]||(a[8]=[i("mdi-food-fork-drink")])),_:1}),a[9]||(a[9]=i(" Szczegóły "))]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),e(fe,{modelValue:d.value,"onUpdate:modelValue":a[0]||(a[0]=p=>d.value=p),ingredients:n.value},null,8,["modelValue","ingredients"]),e(ye,{modelValue:l.value,"onUpdate:modelValue":a[1]||(a[1]=p=>l.value=p),details:c(o).selectedRecipe,onGetDetails:c(o).getRecipeDetails},null,8,["modelValue","details","onGetDetails"]),e(ge,{open:c(o).recipeDialog,"onUpdate:open":a[2]||(a[2]=p=>c(o).recipeDialog=p),selectedProducts:c(o).selectedProducts,"onUpdate:selectedProducts":a[3]||(a[3]=p=>c(o).selectedProducts=p),allProducts:c(u).products,loading:c(o).loading,recipes:c(o).fetchedRecipes,error:c(o).error,onFetchRecipes:c(o).fetchRecipes,onAddRecipe:c(o).addRecipe,onClose:c(o).closeRecipeDialog},null,8,["open","selectedProducts","allProducts","loading","recipes","error","onFetchRecipes","onAddRecipe","onClose"])]),_:1}))}});export{we as default};
